description: Exploit uniqueness of build key in foreign key simple-hash join using chained hash table with expected
    bucket length of 2.
suite: phys-cost-models
benchmark: simple-hash-join
name: unique build, varying selectivity
readonly: true
chart:
    x:
        scale: linear
        type: Q
        label: 'Selectivity'
    y:
        scale: linear
        type: Q
        label: 'Machine code execution time [ms]'
data:
    'Relation_parent':
        file: 'benchmark/phys-cost-models/data/Relation_parent.csv'
        format: 'csv'
        delimiter: ','
        header: 1
        attributes:
            'id': 'INT NOT NULL PRIMARY KEY'
            'n2m': 'INT NOT NULL'
            'a0': 'INT NOT NULL'
            'a1': 'INT NOT NULL'
            'a2': 'INT NOT NULL'
            'a3': 'INT NOT NULL'
    'Relation_child':
        file: 'benchmark/phys-cost-models/data/Relation_child.csv'
        format: 'csv'
        delimiter: ','
        header: 1
        attributes:
            'id': 'INT NOT NULL'
            'fid_1e_6': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_9e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_8e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_7e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_6e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_5e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_4e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_3e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_2e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_1e_7': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_1e_8': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'fid_1e_9': 'INT NOT NULL REFERENCES Relation_parent(id)'
            'n2m': 'INT NOT NULL'
            'a0': 'INT NOT NULL'
            'a1': 'INT NOT NULL'
            'a2': 'INT NOT NULL'
            'a3': 'INT NOT NULL'
systems:
    mutable:
        args: >-
            --backend WasmV8
            --data-layout Row
            --join-implementations SimpleHash
            --hash-table-implementation Chained
            --hash-table-max-load-factor 2
            --insist-no-rehashing
            --no-simd
        configurations:
            'w/o exploiting unique build':
                args: --no-exploit-unique-build
                pattern: '^Execute machine code:.*'
            'w/ exploiting unique build':
                args: ''
                pattern: '^Execute machine code:.*'
        cases:
            1e-6: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_1e_6;
            9e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_9e_7;
            8e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_8e_7;
            7e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_7e_7;
            6e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_6e_7;
            5e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_5e_7;
            4e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_4e_7;
            3e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_3e_7;
            2e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_2e_7;
            1e-7: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_1e_7;
            1e-8: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_1e_8;
            1e-9: SELECT 1 FROM Relation_parent, Relation_child WHERE Relation_parent.id = Relation_child.fid_1e_9;
